define("user:page/account/findPwd/stepone/stepone.js",function(require,exports,module){"use strict";var $=require("common:widget/lib/jquery/jquery"),service=(require("common:widget/ui/utils/utils"),require("common:widget/ui/service/service-factory")),userService=service.getService("user"),glpbCommon=require("common:node_modules/glpb-components-common/src/index"),RRDValidator=glpbCommon.RRDValidator,findpwd={init:function(){var _this=this;$("#mobileOrEmail").keyup(function(){_this.validateMobileOrEmail()}),$("#code").keyup(function(){_this.validateCode()});var $randImage=$("#randImage"),originCaptcha=$randImage.attr("src");$randImage.on("click",function(){$randImage.attr("src",originCaptcha+"?"+(new Date).getTime())}),$("#subNotLoginFindPswBt").on("click",function(){_this.subFindPwdStepOne()})},subFindPwdStepOne:function(){var that=this;that.validateMobileOrEmail()||that.validateCode()||userService.isImage({code:$("#code").val()}).then(function(res){if(res.requestStatus!==userService.STATUS.SUCCESS){var msg=res.data?res.data.message:"璇锋眰鍚庣鏈嶅姟鍑洪敊, 璇风◢鍚庡啀璇�";return Promise.reject(new Error(msg))}var data=res.data;0==data.status?$("#notLoginFindPswForm").submit():(that.error=data.message,that.errorModal(1))}).caught(function(e){that.error=e.message,that.errorModal(1)})},validateMobileOrEmail:function(){var mobileOrEmail=$("#mobileOrEmail").val(),isMobileOrEmail=RRDValidator.validate.isMobileOrEmail(mobileOrEmail),isSpace=-1==String(mobileOrEmail).indexOf(" ")?!0:!1;return mobileOrEmail?isSpace?isMobileOrEmail?(this.error="",this.errorModal(0),!1):(this.error="璇疯緭鍏ユ纭殑閭鍦板潃鎴栨墜鏈哄彿鐮�",this.errorModal(0),!0):(this.error="涓嶈兘鏈夌┖鏍�",this.errorModal(0),!0):(this.error="鎵嬫満鍙�/閭涓嶈兘涓虹┖",this.errorModal(0),!0)},validateCode:function(){var code=$("#code").val();return code?(this.error="",this.errorModal(1),!1):(this.error="楠岃瘉鐮佷笉鑳戒负绌�",this.errorModal(1),!0)},errorModal:function(num){$("label.error").eq(num).text(this.error),this.error?$(".ui-input-setting").eq(num).addClass("error"):$(".ui-input-setting").eq(num).removeClass("error")}};module.exports=findpwd});